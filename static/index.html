<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数智湖北 - 未来数据预测中心</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 粒子背景库 -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <!-- 配置Tailwind主题 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00F0FF', // 未来蓝
                        secondary: '#B14EFF', // 紫霓虹
                        accent: '#FF0080', // 粉霓虹
                        success: '#39FF14', // 绿霓虹
                        warning: '#FFDD00', // 黄霓虹
                        danger: '#FF073A', // 红霓虹
                        dark: '#0A0E17', // 深空黑
                        'gray-light': '#1E293B',
                        'gray-medium': '#334155'
                    },
                    fontFamily: {
                        cyber: ['Orbitron', 'Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'float': 'float 6s ease-in-out infinite',
                        'scan': 'scan 3s linear infinite',
                        'flicker': 'flicker 0.5s linear infinite alternate',
                        'fade-in': 'fadeIn 1s ease-out forwards',
                        'slide-up': 'slideUp 0.8s ease-out forwards',
                    },
                    keyframes: {
                        glow: {
                            '0%': { boxShadow: '0 0 5px theme(colors.primary), 0 0 10px theme(colors.primary/50)' },
                            '100%': { boxShadow: '0 0 10px theme(colors.primary), 0 0 20px theme(colors.primary/70), 0 0 30px theme(colors.primary/50)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-12px)' },
                        },
                        scan: {
                            '0%': { backgroundPosition: '0 0' },
                            '100%': { backgroundPosition: '0 100%' },
                        },
                        flicker: {
                            '0%': { opacity: 0.8 },
                            '100%': { opacity: 1 },
                        },
                        fadeIn: {
                            '0%': { opacity: 0 },
                            '100%': { opacity: 1 },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(30px)', opacity: 0 },
                            '100%': { transform: 'translateY(0)', opacity: 1 },
                        }
                    }
                },
            }
        }
    </script>
    <!-- 引入未来感字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-glass {
                background: rgba(14, 21, 37, 0.7);
                backdrop-filter: blur(12px);
                border: 1px solid rgba(0, 240, 255, 0.2);
            }
            .card-hover {
                transition: all 0.4s ease;
            }
            .card-hover:hover {
                transform: translateY(-8px) scale(1.01);
                border-color: rgba(0, 240, 255, 0.5);
            }
            .gradient-bg {
                background: linear-gradient(135deg, #0A0E17 0%, #1E293B 100%);
            }
            .text-glow {
                text-shadow: 0 0 4px rgba(0, 240, 255, 0.6), 0 0 8px rgba(0, 240, 255, 0.3);
            }
            .text-glow-purple {
                text-shadow: 0 0 4px rgba(121, 40, 202, 0.6), 0 0 8px rgba(121, 40, 202, 0.3);
            }
            .text-glow-pink {
                text-shadow: 0 0 4px rgba(255, 0, 128, 0.6), 0 0 8px rgba(255, 0, 128, 0.3);
            }
            .text-glow-green {
                text-shadow: 0 0 4px rgba(57, 255, 20, 0.6), 0 0 8px rgba(57, 255, 20, 0.3);
            }
            .scrollbar-custom::-webkit-scrollbar {
                width: 6px;
                height: 6px;
            }
            .scrollbar-custom::-webkit-scrollbar-track {
                background: rgba(14, 21, 37, 0.5);
                border-radius: 3px;
            }
            .scrollbar-custom::-webkit-scrollbar-thumb {
                background: rgba(0, 240, 255, 0.5);
                border-radius: 3px;
            }
            .scrollbar-custom::-webkit-scrollbar-thumb:hover {
                background: rgba(0, 240, 255, 0.8);
            }
            .scan-line {
                background: linear-gradient(to bottom, rgba(0, 240, 255, 0) 0%, rgba(0, 240, 255, 0.8) 50%, rgba(0, 240, 255, 0) 100%);
                background-size: 100% 400%;
            }
            .grid-bg {
                background-image: url('/static/bg.jpg');
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
                background-blend-mode: overlay;
            }
            .neon-border {
                box-shadow: 0 0 5px theme(colors.primary), 0 0 10px theme(colors.primary/50);
            }
            .neon-border-purple {
                box-shadow: 0 0 5px theme(colors.secondary), 0 0 10px theme(colors.secondary/50);
            }
            .neon-border-pink {
                box-shadow: 0 0 5px theme(colors.accent), 0 0 10px theme(colors.accent/50);
            }
            .btn-glow {
                position: relative;
                overflow: hidden;
            }
            .btn-glow::after {
                content: '';
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: linear-gradient(
                    to right,
                    rgba(0, 240, 255, 0) 0%,
                    rgba(0, 240, 255, 0.3) 50%,
                    rgba(0, 240, 255, 0) 100%
                );
                transform: rotate(30deg);
                animation: shine 3s linear infinite;
            }
            .btn-glow-purple::after {
                background: linear-gradient(
                    to right,
                    rgba(121, 40, 202, 0) 0%,
                    rgba(121, 40, 202, 0.3) 50%,
                    rgba(121, 40, 202, 0) 100%
                );
            }
            @keyframes shine {
                0% { transform: rotate(30deg) translateX(-100%); }
                100% { transform: rotate(30deg) translateX(100%); }
            }
            @keyframes fadeIn {
                0% { opacity: 0; }
                100% { opacity: 1; }
            }
            @keyframes slideUp {
                0% { transform: translateY(30px); opacity: 0; }
                100% { transform: translateY(0); opacity: 1; }
            }
            .delay-100 { animation-delay: 0.1s; }
            .delay-200 { animation-delay: 0.2s; }
            .delay-300 { animation-delay: 0.3s; }
            .delay-400 { animation-delay: 0.4s; }
            .delay-500 { animation-delay: 0.5s; }
        }
    </style>
</head>
<body class="font-cyber gradient-bg text-gray-200 scrollbar-custom grid-bg min-h-screen">
    <!-- 粒子背景容器 -->
    <div id="particles-js" class="fixed inset-0 z-0 opacity-70"></div>

    <!-- 导航栏 -->
    <header class="sticky top-0 z-50 card-glass scan-line animate-scan/50 transition-all duration-500">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-3 animate-float">
                <div class="w-12 h-12 rounded-lg bg-gradient-to-r from-primary to-secondary flex items-center justify-center neon-border animate-glow">
                    <i class="fa fa-microchip text-white text-2xl text-glow"></i>
                </div>
                <h1 class="text-2xl font-bold text-primary text-glow">数智湖北<span class="text-secondary text-glow-purple">·未来预测</span></h1>
            </div>

            <nav class="hidden md:flex items-center space-x-8">
                <a href="home" class="text-primary text-glow font-medium relative after:absolute after:bottom-[-4px] after:left-0 after:w-full after:h-0.5 after:bg-primary transition-all hover:text-white">数据预测</a>
                <a href="data_center" class="text-gray-300 font-medium relative after:absolute after:bottom-[-4px] after:left-0 after:w-0 after:h-0.5 after:bg-primary transition-all hover:text-primary hover:after:w-full">数据中心</a>
                <a href="report" class="text-gray-300 font-medium relative after:absolute after:bottom-[-4px] after:left-0 after:w-0 after:h-0.5 after:bg-primary transition-all hover:text-primary hover:after:w-full">分析报告</a>
                <a href="about" class="text-gray-300 font-medium relative after:absolute after:bottom-[-4px] after:left-0 after:w-0 after:h-0.5 after:bg-primary transition-all hover:text-primary hover:after:w-full">关于我们</a>
            </nav>

            <div class="flex items-center space-x-4">
                <button class="hidden md:block px-5 py-2 rounded-lg border border-primary text-primary btn-glow hover:bg-primary/10 transition-all animate-pulse-slow">
                    <i class="fa fa-user-circle mr-1"></i> 登录
                </button>
                <button class="md:hidden text-gray-300 text-2xl hover:text-primary transition-colors">
                    <i class="fa fa-bars"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 英雄区域 -->
    <section class="py-16 md:py-24 relative z-10">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-[clamp(2rem,5vw,3.5rem)] font-bold leading-tight mb-6 animate-fade-in">
                    湖北发展 <span class="text-primary text-glow">数据预测</span>
                    <span class="block text-secondary text-glow-purple mt-2">未来趋势 · 精准洞察</span>
                </h2>
                <p class="text-gray-300 text-lg md:text-xl mb-10 max-w-3xl mx-auto animate-fade-in delay-200">
                    基于量子计算建模与AI深度学习，融合多维度数据链，精准推演湖北经济、民生、产业未来发展轨迹
                </p>
                <div class="flex flex-wrap justify-center gap-6 animate-fade-in delay-300">
                    <button class="px-8 py-4 bg-gradient-to-r from-primary to-secondary text-white rounded-lg hover:from-primary/90 hover:to-secondary/90 transition-all neon-border animate-glow btn-glow text-lg">
                        探索未来 <i class="fa fa-rocket ml-2"></i>
                    </button>
                    <button class="px-8 py-4 bg-transparent text-primary border border-primary rounded-lg hover:bg-primary/10 transition-all neon-border text-lg">
                        模型解析 <i class="fa fa-code-fork ml-2"></i>
                    </button>
                </div>
                <!-- 数据加载状态动画 -->
                <div class="mt-12 flex items-center justify-center space-x-3 animate-fade-in delay-400" id="loading-indicator">
                    <div class="w-3 h-3 rounded-full bg-primary animate-pulse"></div>
                    <div class="w-3 h-3 rounded-full bg-secondary animate-pulse" style="animation-delay: 0.2s"></div>
                    <div class="w-3 h-3 rounded-full bg-accent animate-pulse" style="animation-delay: 0.4s"></div>
                    <span class="text-gray-400 text-sm">加载未来数据中...</span>
                </div>
            </div>
        </div>
    </section>

    <!-- 数据更新提示 -->
    <div class="card-glass border-l-4 border-primary py-4 px-6 mb-12 relative z-10 neon-border animate-slide-up">
        <div class="container mx-auto flex items-center flex-wrap">
            <i class="fa fa-refresh text-primary mr-3 text-xl animate-spin" style="animation-duration: 3s;"></i>
            <p class="text-sm text-gray-300 mr-4 mb-2 md:mb-0">
                <span class="font-medium text-primary">数据更新时间：</span><span id="update-time">加载中...</span>
                <span class="ml-2 text-gray-400">(基于量子模型实时优化)</span>
            </p>
            <a href="home" class="text-primary hover:text-primary/80 text-sm font-medium flex items-center hover:underline">
                查看更新日志 <i class="fa fa-angle-right ml-1"></i>
            </a>
        </div>
    </div>

    <!-- 主要内容区 -->
    <main class="container mx-auto px-4 pb-20 relative z-10">
        <!-- 核心预测指标卡片 -->
        <section class="mb-20">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-10 gap-4 animate-slide-up">
                <h3 class="text-2xl md:text-3xl font-bold text-glow flex items-center">
                    <i class="fa fa-tachometer text-primary mr-3 text-xl"></i> 核心预测指标
                </h3>
                <div class="flex items-center space-x-3 w-full md:w-auto">
                    <span class="text-sm text-gray-400">预测周期：</span>
                    <select class="bg-gray-light border border-primary/30 rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/70 text-gray-200 neon-border" id="period-select">
                        <option>2024年度</option>
                        <option>2024 Q3</option>
                        <option>2025年度</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- GDP预测卡片 -->
                <div class="card-glass rounded-xl p-6 card-hover neon-border animate-slide-up delay-100" id="gdp-card">
                    <div class="flex justify-between items-start mb-5">
                        <div>
                            <h4 class="text-gray-400 text-sm font-medium mb-1">湖北省GDP增速</h4>
                            <p class="text-4xl font-bold mt-1 text-primary text-glow" id="gdp-value">--</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary neon-border">
                            <i class="fa fa-line-chart text-xl"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm mb-4">
                        <span class="text-success flex items-center text-glow-green">
                          <i class="fa fa-arrow-up mr-1"></i> <span id="gdp-change">--</span>
                        </span>
                        <span class="text-gray-400 ml-2" id="gdp-desc">--</span>
                    </div>
                    <div class="mt-2 h-20">
                        <canvas id="gdpChart"></canvas>
                    </div>
                </div>

                <!-- 失业率预测卡片 -->
                <div class="card-glass rounded-xl p-6 card-hover neon-border-purple animate-slide-up delay-200" id="unemployment-card">
                    <div class="flex justify-between items-start mb-5">
                        <div>
                            <h4 class="text-gray-400 text-sm font-medium mb-1">城镇失业率</h4>
                            <p class="text-4xl font-bold mt-1 text-secondary text-glow-purple" id="unemployment-value">--</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center text-secondary neon-border-purple">
                            <i class="fa fa-users text-xl"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm mb-4">
                        <span class="text-danger flex items-center">
                          <i class="fa fa-arrow-up mr-1"></i> <span id="unemployment-change">--</span>
                        </span>
                        <span class="text-gray-400 ml-2" id="unemployment-desc">--</span>
                    </div>
                    <div class="mt-2 h-20">
                        <canvas id="unemploymentChart"></canvas>
                    </div>
                </div>

                <!-- 新能源汽车产量预测卡片 -->
                <div class="card-glass rounded-xl p-6 card-hover neon-border-pink animate-slide-up delay-300" id="ev-card">
                    <div class="flex justify-between items-start mb-5">
                        <div>
                            <h4 class="text-gray-400 text-sm font-medium mb-1">新能源汽车产量</h4>
                            <p class="text-4xl font-bold mt-1 text-accent text-glow-pink" id="ev-value">--</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-accent/10 flex items-center justify-center text-accent neon-border-pink">
                            <i class="fa fa-car text-xl"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm mb-4">
                        <span class="text-success flex items-center text-glow-green">
                          <i class="fa fa-arrow-up mr-1"></i> <span id="ev-change">--</span>
                        </span>
                        <span class="text-gray-400 ml-2" id="ev-desc">--</span>
                    </div>
                    <div class="mt-2 h-20">
                        <canvas id="evChart"></canvas>
                    </div>
                </div>

                <!-- PM2.5预测卡片 -->
                <div class="card-glass rounded-xl p-6 card-hover neon-border animate-slide-up delay-400" id="pm25-card">
                    <div class="flex justify-between items-start mb-5">
                        <div>
                            <h4 class="text-gray-400 text-sm font-medium mb-1">平均PM2.5浓度</h4>
                            <p class="text-4xl font-bold mt-1 text-warning" id="pm25-value">--</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-warning/10 flex items-center justify-center text-warning neon-border">
                            <i class="fa fa-cloud text-xl"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm mb-4">
                        <span class="text-success flex items-center text-glow-green">
                          <i class="fa fa-arrow-down mr-1"></i> <span id="pm25-change">--</span>
                        </span>
                        <span class="text-gray-400 ml-2" id="pm25-desc">--</span>
                    </div>
                    <div class="mt-2 h-20">
                        <canvas id="pm25Chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- 分类预测区域 -->
        <section class="mb-20">
            <!-- 经济发展预测 -->
            <div class="mb-16 animate-slide-up">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold flex items-center text-glow">
                        <i class="fa fa-bar-chart text-primary mr-3"></i> 经济发展预测
                    </h3>
                    <a href="home" class="text-primary hover:text-primary/80 text-sm font-medium flex items-center hover:underline">
                        查看全部 <i class="fa fa-angle-right ml-1"></i>
                    </a>
                </div>

                <div class="card-glass rounded-xl p-6 md:p-8 neon-border">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2">
                            <div class="flex justify-between items-center mb-6">
                                <h4 class="font-semibold text-lg text-gray-100">各市州GDP增速预测（2024）</h4>
                                <div class="flex space-x-3">
                                    <button class="px-4 py-1.5 text-xs rounded-full bg-primary/10 text-primary neon-border">年度</button>
                                    <button class="px-4 py-1.5 text-xs rounded-full bg-gray-light text-gray-400 hover:bg-gray-medium transition-colors">季度</button>
                                    <button class="px-4 py-1.5 text-xs rounded-full bg-gray-light text-gray-400 hover:bg-gray-medium transition-colors">月度</button>
                                </div>
                            </div>
                            <div class="h-80 bg-dark/50 rounded-lg p-4 border border-primary/20">
                                <canvas id="cityGdpChart"></canvas>
                            </div>
                        </div>

                        <div>
                            <h4 class="font-semibold text-lg text-gray-100 mb-6">重点产业产值预测</h4>
                            <div class="space-y-6" id="industry-container">
                                <!-- 重点产业数据将通过JS渲染 -->
                            </div>

                            <div class="mt-8 p-5 bg-primary/5 rounded-lg border border-primary/20">
                                <h5 class="font-medium mb-3 text-sm text-primary text-glow">趋势解读</h5>
                                <p class="text-sm text-gray-300" id="industry-analysis">
                                    加载中...
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 民生服务预测 -->
            <div class="mb-16 animate-slide-up delay-100">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold flex items-center text-glow">
                        <i class="fa fa-heartbeat text-primary mr-3"></i> 民生服务预测
                    </h3>
                    <a href="home" class="text-primary hover:text-primary/80 text-sm font-medium flex items-center hover:underline">
                        查看全部 <i class="fa fa-angle-right ml-1"></i>
                    </a>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 民生商品价格预测 -->
                    <div class="card-glass rounded-xl p-6 md:p-8 neon-border">
                        <h4 class="font-semibold text-lg text-gray-100 mb-6">主要民生商品价格波动预测</h4>
                        <div class="h-64 bg-dark/50 rounded-lg p-4 border border-primary/20">
                            <canvas id="priceChart"></canvas>
                        </div>
                    </div>

                    <!-- 教育医疗资源预测 -->
                    <div class="card-glass rounded-xl p-6 md:p-8 neon-border-purple">
                        <h4 class="font-semibold text-lg text-gray-100 mb-6">教育医疗资源供需预测</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h5 class="text-sm font-medium text-secondary text-glow-purple mb-4">义务教育学位缺口</h5>
                                <div class="space-y-4" id="edu-gap-container">
                                    <!-- 学位缺口数据将通过JS渲染 -->
                                </div>
                            </div>

                            <div>
                                <h5 class="text-sm font-medium text-secondary text-glow-purple mb-4">重点医院就诊高峰</h5>
                                <div class="space-y-4" id="medical-peak-container">
                                    <!-- 就诊高峰数据将通过JS渲染 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 自定义预测工具 -->
        <section class="mb-20 animate-slide-up">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold flex items-center text-glow">
                    <i class="fa fa-calculator text-primary mr-3"></i> 自定义预测工具
                </h3>
                <a href="data_center" class="text-primary hover:text-primary/80 text-sm font-medium flex items-center hover:underline">
                    数据中心 <i class="fa fa-angle-right ml-1"></i>
                </a>
            </div>

            <div class="card-glass rounded-xl p-6 md:p-8 neon-border">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- 参数设置 -->
                    <div class="bg-dark/50 rounded-lg p-6 border border-primary/20">
                        <h4 class="font-medium text-lg text-gray-100 mb-6">参数设置</h4>

                        <div class="space-y-6">
                            <!-- 数据文件选择 -->
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-3">选择数据集</label>
                                <select class="w-full bg-gray-800 border border-primary/30 rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-primary/70 text-gray-200 neon-border" id="data-file-select">
                                    <option value="">加载中...</option>
                                </select>
                            </div>

                            <!-- 地区选择 -->
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-3">预测地区</label>
                                <select class="w-full bg-gray-800 border border-primary/30 rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-primary/70 text-gray-200 neon-border" id="region-select" disabled>
                                    <option value="全市">全市</option>
                                </select>
                            </div>

                            <!-- 预测时长 -->
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-3">预测时长</label>
                                <select class="w-full bg-gray-800 border border-primary/30 rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-primary/70 text-gray-200 neon-border" id="prediction-months">
                                    <option value="1">1个月</option>
                                    <option value="3" selected>3个月</option>
                                    <option value="6">6个月</option>
                                    <option value="12">12个月</option>
                                </select>
                            </div>

                            <button class="w-full py-3 bg-gradient-to-r from-[#00F0FF] to-[#B14EFF] text-white rounded-lg hover:opacity-90 transition-all neon-border" id="generate-prediction">
                                生成预测结果 <i class="fa fa-calculator ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- 预测结果展示 -->
                    <div class="lg:col-span-2">
                        <h4 class="font-medium text-lg text-gray-100 mb-6">预测结果：<span id="current-indicator">请选择参数并生成预测</span></h4>

                        <!-- 图表容器 -->
                        <div class="h-80 bg-dark/50 rounded-lg p-4 border border-primary/20 mb-6 relative">
                            <!-- 加载指示器 -->
                            <div id="prediction-loading" class="hidden absolute inset-0 bg-dark/70 flex items-center justify-center">
                                <i class="fa fa-spinner fa-spin text-2xl text-primary mr-3"></i>
                                <span class="text-gray-300">正在计算预测数据...</span>
                            </div>
                            <canvas id="predictionChart"></canvas>
                        </div>

                        <!-- 预测分析 -->
                        <div class="p-5 bg-primary/5 rounded-lg border border-primary/20">
                            <h5 class="font-medium mb-3 text-sm text-primary text-glow">预测分析</h5>
                            <p class="text-sm text-gray-300 mb-4" id="prediction-analysis">
                                请选择数据集、地区和预测时长，点击"生成预测结果"查看分析...
                            </p>
                            <div class="flex flex-wrap justify-between items-center gap-4">
                                <div class="text-xs text-gray-400">
                                    <span class="inline-block w-3 h-3 rounded-full bg-primary/30 mr-2"></span>
                                    历史数据
                                    <span class="inline-block w-3 h-3 rounded-full bg-secondary ml-4 mr-2"></span>
                                    预测数据
                                </div>
                                <button class="text-primary text-sm hover:underline flex items-center" id="export-data">
                                    <i class="fa fa-download mr-2"></i> 导出数据（CSV）
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark/80 backdrop-blur-md border-t border-primary/20 py-16 relative z-10">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-10">
                <div class="animate-slide-up">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="w-12 h-12 rounded-lg bg-gradient-to-r from-primary to-secondary flex items-center justify-center neon-border animate-glow">
                            <i class="fa fa-microchip text-white text-2xl text-glow"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-primary text-glow">数智湖北<span class="text-secondary text-glow-purple">·未来预测</span></h2>
                    </div>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        运用量子计算与人工智能技术，打造湖北经济社会高质量发展的智能数据引擎，赋能未来决策。
                    </p>
                </div>

                <div class="animate-slide-up delay-100">
                    <h3 class="font-bold text-lg text-gray-100 mb-6">快速链接</h3>
                    <ul class="space-y-4 text-gray-400 text-sm">
                        <li><a href="home" class="hover:text-primary transition-colors flex items-center"><i class="fa fa-angle-right text-primary mr-2"></i> 数据预测</a></li>
                        <li><a href="data_center" class="hover:text-primary transition-colors flex items-center"><i class="fa fa-angle-right text-primary mr-2"></i> 数据中心</a></li>
                        <li><a href="report" class="hover:text-primary transition-colors flex items-center"><i class="fa fa-angle-right text-primary mr-2"></i> 分析报告</a></li>
                        <li><a href="about" class="hover:text-primary transition-colors flex items-center"><i class="fa fa-angle-right text-primary mr-2"></i> 关于我们</a></li>
                        <li><a href="home" class="hover:text-primary transition-colors flex items-center"><i class="fa fa-angle-right text-primary mr-2"></i> 帮助中心</a></li>
                    </ul>
                </div>

                <div class="animate-slide-up delay-200">
                    <h3 class="font-bold text-lg text-gray-100 mb-6">联系我们</h3>
                    <ul class="space-y-4 text-gray-400 text-sm">
                        <li class="flex items-start">
                            <i class="fa fa-envelope-o text-primary mt-1 mr-3 text-lg"></i>
                            <span>contact@shuzhi-hubei.com</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa fa-phone text-primary mt-1 mr-3 text-lg"></i>
                            <span>027-8888-9999</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa fa-map-marker text-primary mt-1 mr-3 text-lg"></i>
                            <span>武汉市东湖新技术开发区光谷量子中心A座</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa fa-clock-o text-primary mt-1 mr-3 text-lg"></i>
                            <span>工作日 9:00-18:00（数据实时更新）</span>
                        </li>
                    </ul>
                </div>

                <div class="animate-slide-up delay-300">
                    <h3 class="font-bold text-lg text-gray-100 mb-6">关注我们</h3>
                    <div class="flex space-x-4 mb-6">
                        <a href="home" class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-all neon-border">
                            <i class="fa fa-weixin text-xl"></i>
                        </a>
                        <a href="home" class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-all neon-border">
                            <i class="fa fa-weibo text-xl"></i>
                        </a>
                        <a href="home" class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-all neon-border">
                            <i class="fa fa-github text-xl"></i>
                        </a>
                    </div>
                    <div class="bg-dark/50 rounded-lg p-4 border border-primary/20">
                        <p class="text-gray-400 text-sm mb-3">扫码关注公众号</p>
                        <div class="w-32 h-32 bg-gray-medium rounded flex items-center justify-center">
                            <i class="fa fa-qrcode text-4xl text-dark"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="border-t border-primary/10 mt-12 pt-8 text-center text-gray-500 text-sm">
                <p>© 2025 数智湖北量子数据预测平台 版权所有 | 鄂ICP备12345678号-1 | 数据安全等级：三级等保</p>
                <div class="flex justify-center space-x-6 mt-4">
                    <a href="home" class="hover:text-primary transition-colors">隐私政策</a>
                    <a href="home" class="hover:text-primary transition-colors">服务条款</a>
                    <a href="home" class="hover:text-primary transition-colors">法律声明</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 全局图表实例
        let predictionChart = null;
        let currentPredictionData = null; // 存储当前预测数据用于导出

        // 初始化粒子背景
        particlesJS("particles-js", {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: "#00F0FF" },
                shape: { type: "circle" },
                opacity: { value: 0.2, random: true },
                size: { value: 3, random: true },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: "#00F0FF",
                    opacity: 0.1,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 0.5,
                    direction: "none",
                    random: true,
                    straight: false,
                    out_mode: "out",
                    bounce: false
                }
            },
            interactivity: {
                detect_on: "canvas",
                events: {
                    onhover: { enable: true, mode: "grab" },
                    onclick: { enable: true, mode: "push" },
                    resize: true
                },
                modes: {
                    grab: { distance: 140, line_linked: { opacity: 0.3 } },
                    push: { particles_nb: 3 }
                }
            },
            retina_detect: true
        });

        // 页面加载完成后请求后端接口获取所有数据
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // 隐藏加载指示器
                const hideLoading = () => {
                    document.getElementById('loading-indicator').style.opacity = 0;
                    setTimeout(() => {
                        document.getElementById('loading-indicator').style.display = 'none';
                    }, 500);
                };

                // 1. 获取核心预测指标数据
                const coreIndicatorsRes = await fetch('/api/core-indicators');
                const coreIndicators = await coreIndicatorsRes.json();

                // 2. 获取市州GDP数据
                const cityGdpRes = await fetch('/api/city-gdp');
                const cityGdpData = await cityGdpRes.json();

                // 3. 获取重点产业数据
                const industryRes = await fetch('/api/industries');
                const industryData = await industryRes.json();

                // 4. 获取民生商品价格数据
                const priceRes = await fetch('/api/commodity-prices');
                const priceData = await priceRes.json();

                // 5. 获取教育医疗资源数据
                const eduMedRes = await fetch('/api/edu-med-resources');
                const eduMedData = await eduMedRes.json();

                // 更新数据更新时间
                document.getElementById('update-time').textContent = coreIndicators.update_time;

                // --- 渲染核心指标数据 ---
                renderCoreIndicators(coreIndicators);

                // --- 渲染市州GDP图表 ---
                initCityGdpChart(cityGdpData);

                // --- 渲染重点产业数据 ---
                renderIndustries(industryData);

                // --- 渲染民生商品价格图表 ---
                initPriceChart(priceData);

                // --- 渲染教育医疗资源数据 ---
                renderEduMed(eduMedData);

                // --- 初始化自定义预测功能 ---
                initCustomPrediction();

                // 隐藏加载指示器
                hideLoading();

            } catch (error) {
                console.error('数据请求失败:', error);
                document.getElementById('loading-indicator').innerHTML = `
                    <i class="fa fa-exclamation-circle text-danger mr-2"></i>
                    <span class="text-danger text-sm">数据加载失败，请刷新页面重试</span>
                `;
            }
        });

        // --- 核心指标渲染函数 ---
        function renderCoreIndicators(data) {
            // GDP
            document.getElementById('gdp-value').textContent = `${data.gdp.value}%`;
            document.getElementById('gdp-change').textContent = data.gdp.change;
            document.getElementById('gdp-desc').textContent = data.gdp.desc;
            initSmallChart('gdpChart', data.gdp.labels, data.gdp.data, '#00F0FF');

            // 失业率
            document.getElementById('unemployment-value').textContent = `${data.unemployment.value}%`;
            document.getElementById('unemployment-change').textContent = data.unemployment.change;
            document.getElementById('unemployment-desc').textContent = data.unemployment.desc;
            initSmallChart('unemploymentChart', data.unemployment.labels, data.unemployment.data, '#7928CA');

            // 新能源汽车
            document.getElementById('ev-value').textContent = `${data.ev.value}%`;
            document.getElementById('ev-change').textContent = data.ev.change;
            document.getElementById('ev-desc').textContent = data.ev.desc;
            initSmallChart('evChart', data.ev.labels, data.ev.data, '#FF0080');

            // PM2.5
            document.getElementById('pm25-value').textContent = `${data.pm25.value}μg/m³`;
            document.getElementById('pm25-change').textContent = data.pm25.change;
            document.getElementById('pm25-desc').textContent = data.pm25.desc;
            initSmallChart('pm25Chart', data.pm25.labels, data.pm25.data, '#FFDD00');
        }

        // --- 小型趋势图初始化函数 ---
        function initSmallChart(domId, labels, data, color) {
            const ctx = document.getElementById(domId).getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderColor: color,
                        backgroundColor: `${color}20`,
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { display: false, grid: { display: false } },
                        y: { display: false, grid: { display: false } }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // --- 市州GDP图表初始化 ---
        function initCityGdpChart(data) {
            const ctx = document.getElementById('cityGdpChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.cities,
                    datasets: [
                        {
                            label: '2023实际值',
                            data: data.actual2023,
                            backgroundColor: 'rgba(0, 240, 255, 0.6)',
                            borderRadius: 4,
                            borderWidth: 0
                        },
                        {
                            label: '2024预测值',
                            data: data.pred2024,
                            backgroundColor: 'rgba(121, 40, 202, 0.8)',
                            borderRadius: 4,
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 8,
                                color: '#E2E8F0',
                                font: { size: 11 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + '%';
                                }
                            },
                            backgroundColor: 'rgba(14, 21, 37, 0.9)',
                            borderColor: 'rgba(0, 240, 255, 0.5)',
                            borderWidth: 1,
                            padding: 12,
                            titleFont: { size: 13 },
                            bodyFont: { size: 12 }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false, drawBorder: false },
                            ticks: { color: '#94A3B8', font: { size: 11 } }
                        },
                        y: {
                            beginAtZero: false,
                            min: 4,
                            grid: { color: 'rgba(0, 240, 255, 0.1)', drawBorder: false },
                            ticks: {
                                color: '#94A3B8',
                                font: { size: 11 },
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 2500,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // --- 重点产业渲染 ---
        function renderIndustries(data) {
            const container = document.getElementById('industry-container');
            const colorMap = {
                'primary': '#00F0FF',
                'secondary': '#7928CA',
                'accent': '#FF0080',
                'success': '#39FF14'
            };

            container.innerHTML = data.map(ind => `
                <div class="animate-fade-in delay-${data.indexOf(ind) * 100}">
                    <div class="flex justify-between mb-2">
                        <span class="text-sm text-gray-300">${ind.name}</span>
                        <span class="text-sm font-medium text-${ind.color} text-glow">${ind.growth}</span>
                    </div>
                    <div class="w-full bg-gray-light rounded-full h-2.5 overflow-hidden">
                        <div class="h-2.5 rounded-full" style="width: ${ind.percent}%; background-color: ${colorMap[ind.color]}; box-shadow: 0 0 8px ${colorMap[ind.color]}80;"></div>
                    </div>
                </div>
            `).join('');

            // 产业分析
            document.getElementById('industry-analysis').textContent =
                "光电子产业预计将保持高速增长，主要受益于武汉'光谷'持续的技术突破和产业集群效应。汽车产业在新能源转型推动下，增速有望回升，生物医药与装备制造产业将稳步发展。";
        }

        // --- 民生商品价格图表初始化 ---
        function initPriceChart(data) {
            const ctx = document.getElementById('priceChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.months,
                    datasets: [
                        {
                            label: '猪肉',
                            data: data.pork,
                            borderColor: '#FF073A',
                            backgroundColor: 'rgba(255, 7, 58, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#FF073A'
                        },
                        {
                            label: '大米',
                            data: data.rice,
                            borderColor: '#00F0FF',
                            backgroundColor: 'rgba(0, 240, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#00F0FF'
                        },
                        {
                            label: '食用油',
                            data: data.oil,
                            borderColor: '#39FF14',
                            backgroundColor: 'rgba(57, 255, 20, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 3,
                            pointBackgroundColor: '#39FF14'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                boxWidth: 8,
                                color: '#E2E8F0',
                                font: { size: 11 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(14, 21, 37, 0.9)',
                            borderColor: 'rgba(0, 240, 255, 0.5)',
                            borderWidth: 1,
                            padding: 12,
                            titleFont: { size: 13 },
                            bodyFont: { size: 12 },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ¥' + context.raw;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false, drawBorder: false },
                            ticks: { color: '#94A3B8', font: { size: 11 } }
                        },
                        y: {
                            grid: { color: 'rgba(0, 240, 255, 0.1)', drawBorder: false },
                            ticks: {
                                color: '#94A3B8',
                                font: { size: 11 },
                                callback: function(value) {
                                    return '¥' + value;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 2500,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // --- 教育医疗资源渲染 ---
        function renderEduMed(data) {
            // 学位缺口
            const eduContainer = document.getElementById('edu-gap-container');
            eduContainer.innerHTML = data.edu_gap.map((item, index) => `
                <div class="animate-fade-in delay-${index * 100}">
                    <div class="flex justify-between items-center mb-1.5">
                        <span class="text-xs text-gray-300">${item.city}</span>
                        <span class="text-xs font-medium text-${item.color}">${item.gap}</span>
                    </div>
                    <div class="w-full bg-gray-light rounded-full h-2 overflow-hidden">
                        <div class="h-2 rounded-full" style="width: ${item.percent}%; background-color: var(--tw-color-${item.color}); box-shadow: 0 0 6px var(--tw-color-${item.color})80;"></div>
                    </div>
                </div>
            `).join('');

            // 就诊高峰
            const medicalContainer = document.getElementById('medical-peak-container');
            medicalContainer.innerHTML = data.medical_peak.map((item, index) => `
                <div class="animate-fade-in delay-${index * 100}">
                    <div class="flex justify-between items-center mb-1.5">
                        <span class="text-xs text-gray-300">${item.name}</span>
                        <span class="text-xs font-medium text-${item.color}">${item.period}</span>
                    </div>
                    <div class="w-full bg-gray-light rounded-full h-2 overflow-hidden">
                        <div class="h-2 rounded-full" style="width: ${item.percent}%; background-color: var(--tw-color-${item.color}); box-shadow: 0 0 6px var(--tw-color-${item.color})80;"></div>
                    </div>
                </div>
            `).join('');
        }

        // --- 自定义预测功能相关 ---
        function initCustomPrediction() {
            loadDataFiles();
            bindPredictionEvents();
        }

        // 加载数据文件列表
        async function loadDataFiles() {
            try {
                const res = await fetch('/api/data-files');
                if (!res.ok) throw new Error('加载文件列表失败');

                const data = await res.json();
                const fileSelect = document.getElementById('data-file-select');

                if (data.files && data.files.length > 0) {
                    fileSelect.innerHTML = '';
                    data.files.forEach(file => {
                        const option = document.createElement('option');
                        option.value = file;
                        option.textContent = file.replace('.csv', '');
                        fileSelect.appendChild(option);
                    });
                    fileSelect.disabled = false;
                    // 加载默认文件的地区
                    loadRegions();
                } else {
                    fileSelect.innerHTML = '<option value="">无可用数据文件</option>';
                }
            } catch (error) {
                console.error('加载文件列表错误:', error);
                document.getElementById('data-file-select').innerHTML = '<option value="">加载失败</option>';
            }
        }

        // 加载地区列表
        async function loadRegions() {
            const fileSelect = document.getElementById('data-file-select');
            const regionSelect = document.getElementById('region-select');
            const filename = fileSelect.value;

            if (!filename) {
                regionSelect.innerHTML = '<option value="全市">全市</option>';
                return;
            }

            try {
                regionSelect.disabled = true;
                regionSelect.innerHTML = '<option value="">加载中...</option>';

                const res = await fetch('/api/regions', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({filename})
                });

                if (!res.ok) throw new Error('加载地区列表失败');

                const data = await res.json();
                if (data.regions && data.regions.length > 0) {
                    regionSelect.innerHTML = '';
                    data.regions.forEach(region => {
                        const option = document.createElement('option');
                        option.value = region;
                        option.textContent = region;
                        regionSelect.appendChild(option);
                    });
                } else {
                    regionSelect.innerHTML = '<option value="全市">全市</option>';
                }
            } catch (error) {
                console.error('加载地区错误:', error);
                regionSelect.innerHTML = '<option value="全市">全市（加载失败）</option>';
            } finally {
                regionSelect.disabled = false;
            }
        }

        // 生成预测
        async function generatePrediction() {
            const filename = document.getElementById('data-file-select').value;
            const region = document.getElementById('region-select').value;
            const months = document.getElementById('prediction-months').value;

            if (!filename) {
                alert('请选择数据集');
                return;
            }

            try {
                // 显示加载状态
                document.getElementById('prediction-loading').classList.remove('hidden');
                document.getElementById('prediction-analysis').textContent = '正在生成预测结果...';
                document.getElementById('generate-prediction').disabled = true;

                // 请求预测数据
                const res = await fetch('/api/predict', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({filename, region, months})
                });

                if (!res.ok) {
                    const err = await res.json();
                    throw new Error(err.error || '预测失败');
                }

                const data = await res.json();
                currentPredictionData = data; // 保存数据用于导出
                renderPredictionChart(data);
                document.getElementById('prediction-analysis').textContent = data.analysis;
                document.getElementById('current-indicator').textContent =
                    `${filename.replace('.csv', '')} - ${region}（未来${months}个月）`;

            } catch (error) {
                console.error('预测错误:', error);
                document.getElementById('prediction-analysis').textContent = `预测失败: ${error.message}`;
            } finally {
                document.getElementById('prediction-loading').classList.add('hidden');
                document.getElementById('generate-prediction').disabled = false;
            }
        }

        // 渲染预测图表 - 修复Y轴起点问题和数据异常
        function renderPredictionChart(data) {
            const ctx = document.getElementById('predictionChart').getContext('2d');

            // 销毁已有图表
            if (predictionChart) {
                predictionChart.destroy();
            }

            // 合并历史和预测标签
            const allLabels = [...data.historical.labels, ...data.predictions.labels];

            // 准备图表数据集
            const chartDatasets = [];

            // 收集所有有效数据点用于计算Y轴范围
            let allDataPoints = [];

            // 添加历史数据到图表
            data.historical.datasets.forEach(dataset => {
                // 历史数据后面补null，与预测数据长度匹配
                const fullData = [...dataset.data, ...new Array(data.predictions.labels.length).fill(null)];
                // 收集有效数据点
                dataset.data.forEach(point => {
                    if (point !== null && point !== undefined) {
                        allDataPoints.push(point);
                    }
                });

                chartDatasets.push({
                    label: `历史${dataset.label}`,
                    data: fullData,
                    borderColor: dataset.borderColor,
                    borderWidth: 2,
                    pointRadius: 3,
                    pointHoverRadius: 5,
                    tension: dataset.tension,
                    fill: dataset.fill
                });
            });

            // 添加预测数据到图表
            data.predictions.datasets.forEach(dataset => {
                // 预测数据前面补null，与历史数据长度匹配
                const fullData = [...new Array(data.historical.labels.length).fill(null), ...dataset.data];
                // 收集有效数据点
                dataset.data.forEach(point => {
                    if (point !== null && point !== undefined) {
                        allDataPoints.push(point);
                    }
                });

                chartDatasets.push({
                    label: `预测${dataset.label}`,
                    data: fullData,
                    borderColor: dataset.borderColor,
                    borderWidth: 2,
                    borderDash: dataset.borderDash,
                    pointRadius: 3,
                    pointHoverRadius: 5,
                    tension: dataset.tension,
                    fill: dataset.fill
                });
            });

            // 计算Y轴合适的范围
            const minVal = Math.min(...allDataPoints);
            const maxVal = Math.max(...allDataPoints);
            const range = maxVal - minVal;

            // 计算Y轴最小值（比最小数据点低5-10%）
            const yMin = minVal - (range * 0.1);
            // 计算Y轴最大值（比最大数据点高5-10%）
            const yMax = maxVal + (range * 0.1);

            // 创建新图表
            predictionChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: allLabels,
                    datasets: chartDatasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        y: {
                            // 关键修复：确保Y轴不从0开始
                            beginAtZero: false,
                            // 设置合适的Y轴范围
                            min: yMin,
                            max: yMax,
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: { color: 'rgba(255, 255, 255, 0.7)' },
                            title: {
                                display: true,
                                text: data.historical.datasets[0].label || '数值',
                                color: 'rgba(255, 255, 255, 0.9)'
                            }
                        },
                        x: {
                            grid: { color: 'rgba(255, 255, 255, 0.05)' },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            title: {
                                display: true,
                                text: '时间',
                                color: 'rgba(255, 255, 255, 0.9)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { color: 'rgba(255, 255, 255, 0.7)' }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(14, 21, 37, 0.9)',
                            titleColor: 'rgba(255, 255, 255, 0.9)',
                            bodyColor: 'rgba(255, 255, 255, 0.7)',
                            borderColor: 'rgba(0, 240, 255, 0.3)',
                            borderWidth: 1
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
        }

        // 导出数据为CSV
        function exportToCSV() {
            if (!currentPredictionData) {
                alert('没有可导出的数据，请先生成预测结果');
                return;
            }

            try {
                // 准备CSV内容
                let csvContent = "时间,";

                // 添加表头
                const indicators = currentPredictionData.historical.datasets.map(ds => ds.label);
                csvContent += indicators.map(ind => `历史${ind},预测${ind}`).join(',') + "\n";

                // 添加历史数据
                currentPredictionData.historical.labels.forEach((label, index) => {
                    let row = `${label},`;
                    currentPredictionData.historical.datasets.forEach(ds => {
                        row += `${ds.data[index] || 0},`;
                        row += ','; // 预测数据位置留空
                    });
                    csvContent += row + "\n";
                });

                // 添加预测数据
                currentPredictionData.predictions.labels.forEach((label, index) => {
                    let row = `${label},`;
                    currentPredictionData.predictions.datasets.forEach((ds, dsIndex) => {
                        row += ','; // 历史数据位置留空
                        row += `${ds.data[index] || 0},`;
                    });
                    csvContent += row + "\n";
                });

                // 创建并下载文件
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `预测数据_${new Date().toLocaleDateString()}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('导出失败:', error);
                alert('数据导出失败，请重试');
            }
        }

        // 绑定预测相关事件
        function bindPredictionEvents() {
            // 文件选择变化时加载地区
            document.getElementById('data-file-select').addEventListener('change', loadRegions);

            // 生成预测按钮点击事件
            document.getElementById('generate-prediction').addEventListener('click', generatePrediction);

            // 导出数据按钮点击事件
            document.getElementById('export-data').addEventListener('click', exportToCSV);
        }
    </script>
</body>
</html>